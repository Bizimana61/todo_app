<div id="<%= dom_id(todo) %>" class="todo-item <%= 'done' if todo.done %> <%= urgency_class(todo) unless todo.done %>" role="listitem">
  <div class="todo-content">
    <div class="todo-header">
      <div style="flex: 1;">
        <h3 class="todo-title">
          <%= todo.description.presence || 'Untitled Todo' %>
        </h3>
        
        <div class="todo-meta">
          <% if todo.due_date.present? %>
            <span class="todo-date">
              <%= todo.due_date.respond_to?(:strftime) ? todo.due_date.strftime("%b %e, %Y") : todo.due_date.to_s %>
            </span>
          <% end %>
          
          <% if !todo.done && urgency_message(todo) %>
            <span class="urgency-badge <%= urgency_class(todo) %>" role="status" aria-live="polite">
              <%= urgency_message(todo) %>
            </span>
          <% end %>
        </div>
      </div>
      
      <!-- Quick checkbox toggle -->
      <%= form_with(model: todo, url: todo_path(todo), method: :patch, local: false, style: 'margin: 0;') do |f| %>
        <label class="form-check" style="margin: 0; cursor: pointer;">
          <%= f.check_box :done, 
              checked: todo.done, 
              onchange: "this.form.submit()", 
              class: 'form-check-input',
              style: 'width: 24px; height: 24px; cursor: pointer;',
              aria: { label: (todo.done ? 'Mark as not done' : 'Mark as done') } %>
        </label>
      <% end %>
    </div>
  </div>
  
  <div class="todo-actions">
    <%= link_to todo, class: 'btn btn-sm btn-ghost', aria: { label: "View #{todo.description || 'todo'}" } do %>
      üëÅÔ∏è View
    <% end %>
    <%= link_to edit_todo_path(todo), class: 'btn btn-sm btn-warning', aria: { label: "Edit #{todo.description || 'todo'}" } do %>
      ‚úèÔ∏è Edit
    <% end %>
    <%= button_to todo_path(todo), 
        method: :delete, 
        class: 'btn btn-sm btn-danger',
        form: { data: Rails.env.test? ? {} : { turbo_confirm: 'Are you sure you want to delete this todo?' } },
        aria: { label: "Delete #{todo.description || 'todo'}" } do %>
      üóëÔ∏è Delete
    <% end %>
  </div>
</div>