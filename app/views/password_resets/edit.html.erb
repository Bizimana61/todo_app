<% content_for :title, "Reset Password - TaskManager" %>

<div class="card" style="max-width: 500px; margin: 2rem auto;">
  <div class="card-header">
    <h1 style="margin: 0; font-weight: 700;">Reset Your Password</h1>
    <p style="margin: 0.5rem 0 0 0; color: var(--color-text-muted);">
      Enter your new password below
    </p>
  </div>

  <%= form_with model: @user, url: password_reset_path(params[:id]), method: :patch do |f| %>
    <%= hidden_field_tag :email, @user.email %>

    <% if @user.errors.any? %>
      <div class="form-error" style="margin-bottom: 2rem; padding: 1rem; background: var(--color-danger-light); border-left: 4px solid var(--color-danger); border-radius: var(--radius-md);">
        <h2 style="margin: 0 0 0.75rem 0; color: var(--color-danger-dark); font-size: 1.125rem; font-weight: 700;">
          <%= pluralize(@user.errors.count, "error") %> prevented your password from being reset:
        </h2>
        <ul style="margin: 0; padding-left: 1.5rem; color: var(--color-danger-dark);">
          <% @user.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= f.label :password, "New Password", class: 'form-label', style: 'font-weight: 600;' %>
      <%= f.password_field :password,
          required: true,
          class: 'form-input',
          placeholder: 'Enter new password',
          autocomplete: 'new-password',
          minlength: 8,
          aria: { describedby: 'password-help' } %>
      <small id="password-help" class="form-help">
        Must be at least 8 characters with a number and special character
      </small>
    </div>

    <div class="form-group">
      <%= f.label :password_confirmation, "Confirm New Password", class: 'form-label', style: 'font-weight: 600;' %>
      <%= f.password_field :password_confirmation,
          required: true,
          class: 'form-input',
          placeholder: 'Re-enter new password',
          autocomplete: 'new-password',
          minlength: 8,
          aria: { describedby: 'password-confirmation-help' } %>
      <small id="password-confirmation-help" class="form-help">
        Must match the password above
      </small>
    </div>

    <div class="form-actions">
      <%= f.submit "Reset Password", class: 'btn btn-primary btn-lg' %>
    </div>
  <% end %>
</div>
